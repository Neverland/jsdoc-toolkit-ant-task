<?xml version="1.0" encoding="UTF-8"?>

<project default="build-complete" basedir="." name="jsdoc-toolkit">

	<echo message="pulling in property files" />
	<property file="build.properties" />
    
    <target name="build-compile" depends="compile, create-docs" />
	<target name="build-jar" depends="create-jar, test-jar" />
	<target name="build-complete" depends="compile, create-docs, create-jar, test-jar" />
	
	<target name="compile" description="Compile source files">
        <javac 
         srcdir="src" destdir="bin"
         classpath="libs/java/ant.jar:/Users/darrenh/tmp/js.jar"
        />
	</target>

	<target name="create-docs">
		<javadoc sourcepath="src" destdir="javadoc"/>
	</target>

	<target name="create-jar" description="Create a JAR of the JsDoc Toolkit ant task">
		<jar destfile="jsdoctoolkit.jar">
		    <fileset dir="bin"/>
		    <manifest>
		      <attribute name="Built-By" value="Darren Hurley"/>
		    </manifest>
		</jar>
	</target>
	
	<!-- test jar -->
	<target name="test-jar">
		<taskdef name="jsdoctoolkit" classname="uk.co.darrenhurley.ant.tasks.JsDocToolkit" classpath="jsdoctoolkit.jar:libs/java/js.jar"/>
        <!-- test it works with version 1 -->
        <jsdoctoolkit jsdochome="${jsdoc-1.home}" template="sunny" outputdir="${test.output.dir}vesion1-testone/" inputdir="${basedir}/tests/jsdoctoolkit/" />
        <jsdoctoolkit jsdochome="${jsdoc-1.home}" template="sunny" outputdir="${test.output.dir}vesion1-testtwo/">
            <source file="${basedir}/tests/jsdoctoolkit/test.js" />
        </jsdoctoolkit>
		<!-- test it works with version 2 -->
		<jsdoctoolkit jsdochome="${jsdoc-2.home}" template="jsdoc" outputdir="${test.output.dir}vesion2-testone/" inputdir="${basedir}/tests/jsdoctoolkit/" />
        <jsdoctoolkit jsdochome="${jsdoc-2.home}" template="jsdoc" outputdir="${test.output.dir}vesion2-testtwo/">
            <source file="${basedir}/tests/jsdoctoolkit/test.js" />
        </jsdoctoolkit> 
	</target>
	

</project>